{"version":3,"sources":["addcart.class.es6"],"names":[],"mappings":";;qjBAAA;;;;;AAGA;;;;IAEM,O;AACF,qBAAa,KAAb,EAAoB,IAApB,EAAyB;AAAA;;AACrB,aAAK,KAAL,GAAa,KAAb;AACA,aAAK,QAAL,GAAgB,KAAK,QAArB;AACA,aAAK,OAAL,GAAe,KAAK,OAApB,CAHqB,CAGe;;AAEpC,aAAK,SAAL,GAAiB,SAAS,MAAM,IAAN,CAAW,UAAX,CAAT,CAAjB,CALqB,CAK+B;AACpD,aAAK,MAAL,GAAc,SAAS,KAAK,UAAL,IAAmB,CAA5B,CAAd,CANqB,CAM6B;AAClD,aAAK,UAAL;AACH;;;;qCACY;AACT,gBAAI,OAAO,IAAX;AACA,cAAE,QAAF,EAAY,EAAZ,CAAe,OAAf,EAAwB,YAAxB,EAAsC,UAAS,CAAT,EAAW;AAC7C,oBAAG,KAAK,SAAL,IAAkB,KAAK,MAAL,GAAY,CAAjC,EAAmC;AAC/B,yBAAK,SAAL,CAAe,KAAK,SAApB,EAA8B,KAAK,MAAnC;AACH;AACJ,aAJD;AAKH;;;kCAEU,K,EAAO,M,EAAO;AAAA,gBAChB,IADgB,GACR,IADQ;;AAErB,cAAE,IAAF,CAAO;AACH,qBAAK,EADF;AAEH,sBAAK,MAFF;AAGH,sBAAM,EAAC,aAAa,KAAd,EAAqB,UAAU,MAA/B,EAHH;AAIH,4BAAY,sBAAU;AAClB,wBAAG,CAAC,KAAJ,EAAU;AACN,+BAAO,KAAP;AACH;AACJ,iBARE;AASH,yBAAS,iBAAS,IAAT,EAAc;AACnB,2BAAO;AACH,iCAAS,KADN;AAEH,6BAAK,SAFF;AAGH,6BAAI;AAHD,qBAAP;AAKA,wBAAG,KAAK,OAAR,EAAgB;AACZ,0BAAE,GAAF,CAAM;AACF,kCAAM,MADJ;AAEF,uCAAW,IAFT;AAGF,qCAAS,KAAK;AAHZ,yBAAN;AAKA,6BAAK,OAAL,CAAa,IAAb,CAAkB,KAAK,GAAvB;AACH,qBAPD,MAOK;AACD,0BAAE,GAAF,CAAM;AACF,kCAAM,MADJ;AAEF,uCAAW,IAFT;AAGF,qCAAS,KAAK;AAHZ,yBAAN;AAKH;AAEJ;AA9BE,aAAP;AAgCH;;;;;;AAGL;;;;;;;;AAMA,EAAE,EAAF,CAAK,OAAL,GAAe,UAAS,IAAT,EAAc;AACzB,QAAG,QAAQ,KAAK,OAAhB,EAAwB;AACpB,YAAI,KAAK,IAAI,OAAJ,CAAY,EAAE,IAAF,CAAZ,EAAqB,IAArB,CAAT;AACH;AACJ,CAJD","file":"addcart.class.js","sourcesContent":["/**\r\n * Created by xiangran.kong on 16/08/09.\r\n */\r\nimport {getUnit, eventUnit, cookieUnit} from './../unit/unit.js';\r\n\r\nclass AddCart {\r\n    constructor ($this, opts){\r\n        this.$this = $this;\r\n        this.bindName = opts.bindName;\r\n        this.$status = opts.$status;        //购物车状态，显示数量\r\n\r\n        this.productId = parseInt($this.attr('data-pid'));  //产品id\r\n        this.number = parseInt(this.$addNumber || 1) ;    //加入购物车数量，默认1\r\n        this._eventBind();\r\n    } \r\n    _eventBind (){\r\n        let that = this;\r\n        $(document).on('click', '.J_AddCart', function(e){\r\n            if(that.productId && that.number>0){\r\n                that._sendAjax(that.productId,that.number);\r\n            }\r\n        });\r\n    }\r\n\r\n    _sendAjax (proId, number){\r\n        let [that]= [this];\r\n        $.ajax({\r\n            url: '',\r\n            type:'post',\r\n            data: {'productId': proId, 'number': number},\r\n            beforeSend: function(){\r\n                if(!proId){\r\n                    return false;\r\n                }\r\n            },\r\n            success: function(data){\r\n                data = {\r\n                    success: false,\r\n                    msg: '加入购物车失败',\r\n                    sum:2\r\n                };\r\n                if(data.success){\r\n                    $.pop({\r\n                        type: 'tips',\r\n                        hideTimes: 5000,\r\n                        message: data.msg\r\n                    });\r\n                    that.$status.text(data.sum);\r\n                }else{\r\n                    $.pop({\r\n                        type: 'tips',\r\n                        hideTimes: 5000,\r\n                        message: data.msg\r\n                    })\r\n                }\r\n\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * 加入购物车\r\n * 加入购物车的按钮中要有class: J_AddCart, data-pid=\"27598\"(产品pid)\r\n * opts.$addNumber 要记入购物的数量，默认为1\r\n * opts.$status  要显示购物车数量的jquery对象\r\n * **/\r\n$.fn.addCart = function(opts){\r\n    if(opts && opts.$status){\r\n        let ac = new AddCart($(this), opts);\r\n    }\r\n};\r\n"]}