<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>我的收藏</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
<header class="l-head">
    <button type="button" class="back" onclick="history.go(-1)"><span class="icon icon-back"></span></button>
    <h2 class="title">我的收藏</h2>
</header>
<div class="l-content favorites-box751" id="J_ScrollContain">
    <div class="m-card" id="J_TabContent" data-page="1">
        <div class="m-card-widthwise">
            <div class="card-label">
                <div class="card-img">
                    <a href="">
                        <img class="lazy" src="http://fieldsimage.oss-cn-hangzhou.aliyuncs.com/product/201605/1464355775765209_s2.png" alt="">
                    </a>
                </div>
                <div class="card-info">
                    <a href="">11111111111111新奇士 新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）（葡萄柚）</a>
                    <p>产地：多汁而清爽多汁而清爽多汁而清爽多汁而清爽多汁而清爽</p>
                    <p>规格：2个（600-800克2个（600-800克2个（600-800克2个（600-800克）</p>
                </div>
            </div>
            <p class="card-price">
                <span class="price">￥30</span>
                <span class="del">￥35</span>
                <span class="icon icon-love-green J_removeCol"></span>
                <span class="icon icon-cart-active"></span>
            </p>
        </div>
        <div class="m-card-widthwise">
            <div class="card-label">
                <div class="card-img">
                    <a href="">
                        <img class="lazy" src="http://fieldsimage.oss-cn-hangzhou.aliyuncs.com/product/201605/1464355775765209_s2.png" alt="">
                    </a>
                </div>
                <div class="card-info">
                    <a href="">222222222新奇士 新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）（葡萄柚）</a>
                    <p>产地：多汁而清爽多汁而清爽多汁而清爽多汁而清爽多汁而清爽</p>
                    <p>规格：2个（600-800克2个（600-800克2个（600-800克2个（600-800克）</p>
                </div>
            </div>
            <p class="card-price">
                <span class="price">￥30</span>
                <span class="del">￥35</span>
                <span class="icon icon-love-green J_removeCol"></span>
                <span class="icon icon-cart-active"></span>
            </p>
        </div>
        <div class="m-card-widthwise">
            <div class="card-label">
                <div class="card-img">
                    <a href="">
                        <img class="lazy" src="http://fieldsimage.oss-cn-hangzhou.aliyuncs.com/product/201605/1464355775765209_s2.png" alt="">
                    </a>
                </div>
                <div class="card-info">
                    <a href="">3333333新奇士 新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）（葡萄柚）</a>
                    <p>产地：多汁而清爽多汁而清爽多汁而清爽多汁而清爽多汁而清爽</p>
                    <p>规格：2个（600-800克2个（600-800克2个（600-800克2个（600-800克）</p>
                </div>
            </div>
            <p class="card-price">
                <span class="price">￥30</span>
                <span class="del">￥35</span>
                <span class="icon icon-love-green J_removeCol"></span>
                <span class="icon icon-cart-active"></span>
            </p>
        </div>
        <div class="m-card-widthwise">
            <div class="card-label">
                <div class="card-img">
                    <a href="">
                        <img class="lazy" src="http://fieldsimage.oss-cn-hangzhou.aliyuncs.com/product/201605/1464355775765209_s2.png" alt="">
                    </a>
                </div>
                <div class="card-info">
                    <a href="">4444444444444新奇士 新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）（葡萄柚）</a>
                    <p>产地：多汁而清爽多汁而清爽多汁而清爽多汁而清爽多汁而清爽</p>
                    <p>规格：2个（600-800克2个（600-800克2个（600-800克2个（600-800克）</p>
                </div>
            </div>
            <p class="card-price">
                <span class="price">￥30</span>
                <span class="del">￥35</span>
                <span class="icon icon-love-green J_removeCol"></span>
                <span class="icon icon-cart-active"></span>
            </p>
        </div>
        <div class="m-card-widthwise">
            <div class="card-label">
                <div class="card-img">
                    <a href="">
                        <img class="lazy" src="http://fieldsimage.oss-cn-hangzhou.aliyuncs.com/product/201605/1464355775765209_s2.png" alt="">
                    </a>
                </div>
                <div class="card-info">
                    <a href="">55555555555新奇士 新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）（葡萄柚）</a>
                    <p>产地：多汁而清爽多汁而清爽多汁而清爽多汁而清爽多汁而清爽</p>
                    <p>规格：2个（600-800克2个（600-800克2个（600-800克2个（600-800克）</p>
                </div>
            </div>
            <p class="card-price">
                <span class="price">￥30</span>
                <span class="del">￥35</span>
                <span class="icon icon-love-green J_removeCol"></span>
                <span class="icon icon-cart-active"></span>
            </p>
        </div>
        <div class="m-card-widthwise">
            <div class="card-label">
                <div class="card-img">
                    <a href="">
                        <img class="lazy" src="http://fieldsimage.oss-cn-hangzhou.aliyuncs.com/product/201605/1464355775765209_s2.png" alt="">
                    </a>
                </div>
                <div class="card-info">
                    <a href="">666666新奇士 新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）（葡萄柚）</a>
                    <p>产地：多汁而清爽多汁而清爽多汁而清爽多汁而清爽多汁而清爽</p>
                    <p>规格：2个（600-800克2个（600-800克2个（600-800克2个（600-800克）</p>
                </div>
            </div>
            <p class="card-price">
                <span class="price">￥30</span>
                <span class="del">￥35</span>
                <span class="icon icon-love-green J_removeCol"></span>
                <span class="icon icon-cart-active"></span>
            </p>
        </div>
        <div class="m-card-widthwise">
            <div class="card-label">
                <div class="card-img">
                    <a href="">
                        <img class="lazy" src="http://fieldsimage.oss-cn-hangzhou.aliyuncs.com/product/201605/1464355775765209_s2.png" alt="">
                    </a>
                </div>
                <div class="card-info">
                    <a href="">77777新奇士 新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）新奇士 加州星路比西柚（葡萄柚）（葡萄柚）</a>
                    <p>产地：多汁而清爽多汁而清爽多汁而清爽多汁而清爽多汁而清爽</p>
                    <p>规格：2个（600-800克2个（600-800克2个（600-800克2个（600-800克）</p>
                </div>
            </div>
            <p class="card-price">
                <span class="price">￥30</span>
                <span class="del">￥35</span>
                <span class="icon icon-love-green J_removeCol"></span>
                <span class="icon icon-cart-active"></span>
            </p>
        </div>
    </div>
    <p class="end751" id="J_LoadState">上拉加载更多...</p>
</div>
<script src="../dist/js/common.js?v=1.0.1"></script>
<script src="../dist/js/user.js?v=1.0.1"></script>
<script>
    $(function(){
        !function(){
            //加载数据
            var loadData = function(page){
                $tabContent = $('#J_TabContent'),
                pages = page || $tabContent.attr('data-page');

                $.ajax({
                    url:'',
                    type: 'post',
                    //data:{'category_id': category_id, 'page':page},
                    success: function(data){
                        /**假数据，每次加载20个**/
                        data = {
                            success: true,
                            page: 0,
                            json: [
                                {
                                    img:'http://image.fieldschina.com/product/201606/1465399368102999_s2.jpg',
                                    href:'foods-details.html',
                                    til:' 11111有机红小番茄11111',
                                    producer: '产地: 上海',
                                    standard: '规格: 270-300g',
                                    nowPrice: '¥19',
                                    delPrice: '¥190'
                                },
                                {
                                    img:'http://image.fieldschina.com/product/201606/1465399368102999_s2.jpg',
                                    href:'foods-details.html',
                                    til:' 2222有机222红2小番茄222',
                                    producer: '产地: 上海',
                                    standard: '规格: 270-300g',
                                    nowPrice: '¥19',
                                    delPrice: '¥190'
                                }
                            ],
                            message:'加载完成'
                        };
                        if(data.success){
                            //数据填充
                            var html='';
                            for(var i in data.json){
                                html += '<div class=\"m-card-widthwise\"><div class=\"card-label\"><div class=\"card-img\"><a href=\"' + data.json[i].href + '\"><img class=\"lazy\" src=\"' + data.json[i].img + '\" alt=\"\"></a></div><div class=\"card-info\"><a href=\"' + data.json[i].href + '\">' + data.json[i].til + '</a><p>' + data.json[i].producer + '</p><p>' + data.json[i].standard + '</p></div></div><p class="card-price"><span class="price">' + data.json[i].nowPrice + '</span> <span class="del">' + data.json[i].delPrice + '</span><span class="icon icon-love-green J_removeCol"></span> <span class="icon icon-cart-active"></span></p></div>';
                            }
                            $tabContent.append(html);
                            $tabContent.attr('data-page',data.page);
                            $('#J_LoadState').text();
                        }

                    }
                })
            };

            //下拉的时候加载数据
            $(window).scroll(function(e){
                var $con = $('#J_ScrollContain'),
                    height= $con.height(),
                    screenHeight = $('body').height(),
                    offsetHeight= $(window).scrollTop();

                //当距离底部小于一屏幕高度
                if((height-screenHeight-offsetHeight)<screenHeight){
                    var $content = $('#J_TabContent'),
                        page = parseInt($content.attr('data-page')),
                        catId;
                    if(page){
                        catId = $('#J_TabCat').find('active').attr('data-categoryid');
                        loadData(catId, page);
                    }
                }
            });
        }();

        $('body').delegate('.J_removeCol', 'tap', function () {
            var t = $(this),
                card = t.parent().parent(),
                w = card.width();

            // 收藏全部删除后跳转到空收藏页
            if($('.m-card').children().length == 1){
                window.location = 'https://github.com/';
            }

            card.addClass('transition').css({
                width: w+'px',
                marginLeft: -w+'px'
            });
            setTimeout(function(){
                card.remove();
            },400);
        });
    });
</script>
</body>
</html>
